<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="MRCTF2020_misc&amp;Crypto"><meta name="keywords" content="misc,crypto"><meta name="author" content="John Doe"><meta name="copyright" content="John Doe"><title>MRCTF2020_misc&amp;Crypto | Hexo</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.9.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.9.0"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  hexoVersion: '5.3.0'
} </script><meta name="generator" content="Hexo 5.3.0"></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="true"><div class="toggle-sidebar-info text-center"><span data-toggle="Toggle article">Toggle site</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#MISC"><span class="toc-number">1.</span> <span class="toc-text">MISC</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#MRCTF2020-CyberPunk"><span class="toc-number">1.1.</span> <span class="toc-text">[MRCTF2020]CyberPunk</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MRCTF2020-%E5%AF%BB%E6%89%BExxx"><span class="toc-number">1.2.</span> <span class="toc-text">[MRCTF2020]寻找xxx</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MRCTF2020-ezmisc"><span class="toc-number">1.3.</span> <span class="toc-text">[MRCTF2020]ezmisc</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MRCTF2020-%E4%B8%8D%E7%9C%A0%E4%B9%8B%E5%A4%9C"><span class="toc-number">1.4.</span> <span class="toc-text">[MRCTF2020]不眠之夜</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MRCTF2020-Hello-misc"><span class="toc-number">1.5.</span> <span class="toc-text">[MRCTF2020]Hello_ misc</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MRCTF2020-%E6%91%87%E6%BB%9ADJ"><span class="toc-number">1.6.</span> <span class="toc-text">[MRCTF2020]摇滚DJ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MRCTF2020-%E4%BD%A0%E8%83%BD%E7%9C%8B%E6%87%82%E9%9F%B3%E7%AC%A6%E5%90%97"><span class="toc-number">1.7.</span> <span class="toc-text">[MRCTF2020]你能看懂音符吗</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MRCTF2020-%E5%8D%83%E5%B1%82%E5%A5%97%E8%B7%AF"><span class="toc-number">1.8.</span> <span class="toc-text">[MRCTF2020]千层套路</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MRCTF2020-pyFlag"><span class="toc-number">1.9.</span> <span class="toc-text">[MRCTF2020]pyFlag</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MRCTF2020-keyboard"><span class="toc-number">1.10.</span> <span class="toc-text">[MRCTF2020]keyboard</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#CRYPTO"><span class="toc-number">2.</span> <span class="toc-text">CRYPTO</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#MRCTF2020-Easy-RSA"><span class="toc-number">2.1.</span> <span class="toc-text">[MRCTF2020]Easy_RSA</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B7%B2%E7%9F%A5fn%E5%92%8Cn"><span class="toc-number">2.1.1.</span> <span class="toc-text">已知fn和n</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B7%B2%E7%9F%A5e-d%E5%92%8Cn"><span class="toc-number">2.1.2.</span> <span class="toc-text">已知e*d和n</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MRCTF2020-babyRSA"><span class="toc-number">2.2.</span> <span class="toc-text">[MRCTF2020]babyRSA</span></a></li></ol></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">John Doe</div><div class="author-info__description text-center"></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">23</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">21</span></a></div></div></div><div id="content-outer"><div class="no-bg" id="top-container"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Hexo</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right"></span></div><div id="post-info"><div id="post-title">MRCTF2020_misc&amp;Crypto</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-04-06</time></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="MRCTF2020-CyberPunk"><a href="#MRCTF2020-CyberPunk" class="headerlink" title="[MRCTF2020]CyberPunk"></a>[MRCTF2020]CyberPunk</h2><p>签到，Patch程序即可</p>
<h2 id="MRCTF2020-寻找xxx"><a href="#MRCTF2020-寻找xxx" class="headerlink" title="[MRCTF2020]寻找xxx"></a>[MRCTF2020]寻找xxx</h2><p>这个好玩，听电话按键音识别按键，有个网站可以识别，<a target="_blank" rel="noopener" href="http://dialabc.com/sound/detect/index.html">http://dialabc.com/sound/detect/index.html</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">18684221609</span><br></pre></td></tr></table></figure>
<p>如果没有这个网站的话，就用Audacity分析频谱，对照双音多频键盘区分</p>
<blockquote>
<p>电话拨号有两种，脉冲和音频，所谓音频也称双音多频（DTMF）信号的拨号方式，双音多频既是电话拨号时每按一个键，有两个音频频率叠加成一个双音频信号，十二个按键由八个音频频率区分。</p>
</blockquote>
<h2 id="MRCTF2020-ezmisc"><a href="#MRCTF2020-ezmisc" class="headerlink" title="[MRCTF2020]ezmisc"></a>[MRCTF2020]ezmisc</h2><p>png文件格式，<a target="_blank" rel="noopener" href="https://www.cnblogs.com/senior-engineer/p/9548347.html">https://www.cnblogs.com/senior-engineer/p/9548347.html</a></p>
<p>通过CRC校验爆破png文件正确的高和宽，这个脚本收藏了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> zlib</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"></span><br><span class="line">filename = <span class="string">&#x27;flag.png&#x27;</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    all_b = f.read()</span><br><span class="line">    crc32key = <span class="built_in">int</span>(all_b[<span class="number">29</span>:<span class="number">33</span>].<span class="built_in">hex</span>(),<span class="number">16</span>)</span><br><span class="line">    data = <span class="built_in">bytearray</span>(all_b[<span class="number">12</span>:<span class="number">29</span>])</span><br><span class="line">    n = <span class="number">4095</span>            <span class="comment">#理论上0xffffffff,但考虑到屏幕实际/cpu，0x0fff就差不多了</span></span><br><span class="line">    <span class="keyword">for</span> w <span class="keyword">in</span> <span class="built_in">range</span>(n):          <span class="comment">#高和宽一起爆破</span></span><br><span class="line">        width = <span class="built_in">bytearray</span>(struct.pack(<span class="string">&#x27;&gt;i&#x27;</span>, w))     <span class="comment">#q为8字节，i为4字节，h为2字节</span></span><br><span class="line">        <span class="keyword">for</span> h <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">            height = <span class="built_in">bytearray</span>(struct.pack(<span class="string">&#x27;&gt;i&#x27;</span>, h))</span><br><span class="line">            <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">                data[x+<span class="number">4</span>] = width[x]</span><br><span class="line">                data[x+<span class="number">8</span>] = height[x]</span><br><span class="line">            crc32result = zlib.crc32(data)</span><br><span class="line">            <span class="keyword">if</span> crc32result == crc32key:</span><br><span class="line">                print(<span class="string">&quot;宽为：&quot;</span>,end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">                print(width)</span><br><span class="line">                print(<span class="string">&quot;高为：&quot;</span>,end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">                print(height)</span><br><span class="line">                exit(<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<p>得到结果</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">宽为：bytearray(b&#39;\x00\x00\x01\xf4&#39;)</span><br><span class="line">高为：bytearray(b&#39;\x00\x00\x01\xc8&#39;)</span><br></pre></td></tr></table></figure>
<p>改一改文件即可</p>
<h2 id="MRCTF2020-不眠之夜"><a href="#MRCTF2020-不眠之夜" class="headerlink" title="[MRCTF2020]不眠之夜"></a>[MRCTF2020]不眠之夜</h2><p>合并图片，magick，官网，<a target="_blank" rel="noopener" href="https://imagemagick.org/script/index.php">https://imagemagick.org/script/index.php</a></p>
<p>使用ImageMagick montage把多张图片拼成一张大图，<a target="_blank" rel="noopener" href="https://blog.csdn.net/zaffix/article/details/7058587">https://blog.csdn.net/zaffix/article/details/7058587</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">magick montage *.jpg -geometry +0+0 -background #00000000 big.jpg</span><br></pre></td></tr></table></figure>
<p>之后就可用gaps解决拼图问题，安装gaps有点麻烦，官网，<a target="_blank" rel="noopener" href="https://github.com/nemanja-m/gaps%EF%BC%8C%E4%B8%BB%E8%A6%81%E8%BF%98%E5%8F%82%E8%80%83%E4%BA%86%E4%B8%80%E4%B8%8B%E4%B8%A4%E4%B8%AA%E5%8D%9A%E5%AE%A2%EF%BC%8Chttps://blog.csdn.net/qq_45836474/article/details/105353690%EF%BC%8Chttps://www.jianshu.com/p/d9e9019e8148?from=singlemessage">https://github.com/nemanja-m/gaps，主要还参考了一下两个博客，https://blog.csdn.net/qq_45836474/article/details/105353690，https://www.jianshu.com/p/d9e9019e8148?from=singlemessage</a></p>
<p>执行命令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gaps --image&#x3D;big.jpg --population&#x3D;120 --size&#x3D;100 --save --generation&#x3D;400</span><br></pre></td></tr></table></figure>
<p>即可得到完成拼图。不得不说当个脚本小子真的好玩</p>
<h2 id="MRCTF2020-Hello-misc"><a href="#MRCTF2020-Hello-misc" class="headerlink" title="[MRCTF2020]Hello_ misc"></a>[MRCTF2020]Hello_ misc</h2><p>stegsolve红色通道是一个PNG图，得到tips，binwalk，foremost分离图片的压缩包</p>
<p>剩下的有点脑洞，直接贴脚本了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">f = <span class="built_in">open</span>(<span class="string">r&#x27;D:\0Study2\CTF\MRCTF2020\output\zip\00000043\out.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">combo = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    a = f.readline()[:-<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">if</span> a == <span class="string">&quot;&quot;</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    a = <span class="built_in">int</span>(a,<span class="number">10</span>)</span><br><span class="line">    combo += <span class="built_in">bin</span>(a)[<span class="number">2</span>:].rjust(<span class="number">8</span>,<span class="string">&#x27;0&#x27;</span>)[:<span class="number">2</span>]</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(combo) == <span class="number">8</span>:</span><br><span class="line">        print(<span class="built_in">chr</span>(<span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+combo,<span class="number">2</span>)),end = <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        combo = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="comment"># rar-passwd:0ac1fe6b77be5dbe</span></span><br></pre></td></tr></table></figure>
<p>解压得到一个压缩包，再解压得到很多XML文件，一般docx文件解压会得到XML文件，压缩包改为docx打开，他把关键文字改成白色了，所以和背景融为了一体，看上去什么都没有，复制出来即可，后面base64解压找规律，直接贴脚本吧</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">data = [<span class="string">&quot;MTEwMTEwMTExMTExMTEwMDExMTEwMTExMTExMTExMTExMTExMTExMTExMTExMTExMTAxMTEwMDAwMDAxMTExMTExMTExMDAxMTAx&quot;</span>,<span class="string">&quot;MTEwMTEwMTEwMDAxMTAxMDExMTEwMTExMTExMTExMTExMTExMTExMTExMTExMTExMTExMTAxMTExMTExMTExMTExMTEwMTEwMDEx&quot;</span>,<span class="string">&quot;MTEwMDAwMTAxMTEwMTExMDExMTEwMTExMTExMTAwMDExMTExMTExMTExMDAxMDAxMTAxMTEwMDAwMDExMTExMDAwMDExMTExMTEx&quot;</span>,<span class="string">&quot;MTEwMTEwMTAwMDAxMTExMDExMTEwMTExMTExMDExMTAxMTExMTExMTEwMTEwMTEwMTAxMTExMTExMTAwMTEwMTExMTExMTExMTEx&quot;</span>,<span class="string">&quot;MTEwMTEwMTAxMTExMTExMDExMTEwMTExMTAxMDExMTAxMTExMTExMTEwMTEwMTEwMTAxMTAxMTExMTAwMTEwMTExMTExMTExMTEx&quot;</span>,<span class="string">&quot;MTEwMTEwMTAwMDAxMTAwMDAwMTEwMDAwMDAxMTAwMDExMTAwMDAwMTEwMTEwMTEwMTAxMTEwMDAwMDAxMTExMDAwMDExMTExMTEx&quot;</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> data:</span><br><span class="line">    put = base64.b64decode(i).decode().replace(<span class="string">&quot;1&quot;</span>,<span class="string">&quot; &quot;</span>)</span><br><span class="line">    print(put)</span><br><span class="line"></span><br><span class="line"><span class="comment"># He1Lo_mi5c~</span></span><br></pre></td></tr></table></figure>
<h2 id="MRCTF2020-摇滚DJ"><a href="#MRCTF2020-摇滚DJ" class="headerlink" title="[MRCTF2020]摇滚DJ"></a>[MRCTF2020]摇滚DJ</h2><p>SSTV，慢扫描电视，<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E6%85%A2%E6%89%AB%E6%8F%8F%E7%94%B5%E8%A7%86/4229071?fromtitle=sstv&fromid=9387312&fr=aladdin">百科链接</a></p>
<blockquote>
<p><strong>慢扫描电视</strong>（<strong>Slow-scan television</strong>）是业余无线电爱好者的一种主要图片传输方法，慢扫描电视通过无线电传输和接收单色或彩色静态图片。</p>
</blockquote>
<p>用工具QSSTV，具体安装使用方法看<a target="_blank" rel="noopener" href="https://www.yuque.com/jxswcy/ctfwiki/psiyp2">https://www.yuque.com/jxswcy/ctfwiki/psiyp2</a></p>
<h2 id="MRCTF2020-你能看懂音符吗"><a href="#MRCTF2020-你能看懂音符吗" class="headerlink" title="[MRCTF2020]你能看懂音符吗"></a>[MRCTF2020]你能看懂音符吗</h2><p>一个损坏的RAR包，对照RAR格式修复其头部即可，<a target="_blank" rel="noopener" href="https://ctf-wiki.org/misc/archive/rar/">https://ctf-wiki.org/misc/archive/rar/</a></p>
<p>解压后是个docx文档，文档的特定内容被设置为隐藏属性了</p>
<blockquote>
<p>在我们日常使用word的过程中，可能会遇到这么一种情况：有些文字跟段落暂时不确定要不要，不能让人看到，但又因为不确定，所以不敢随便删除。这种时候，很多人可能就会选择备份多一个文档，将不确定的内容另外保存，但往往在繁忙的工作中，就会出现丢失或者搞混的情况。</p>
</blockquote>
<p>首先在选项里面设置显示隐藏信息，这样就可以看到隐藏信息了，但是没办法复制，这时把信息的隐藏属性去掉，就可以复制了，可以看这个，<a target="_blank" rel="noopener" href="https://baijiahao.baidu.com/s?id=1602969523356662152&amp;wfr=spider&amp;for=pc">https://baijiahao.baidu.com/s?id=1602969523356662152&amp;wfr=spider&amp;for=pc</a></p>
<p>一堆音符，是一种加密方式啦，这个网站可以解密，<a target="_blank" rel="noopener" href="https://www.qqxiuzi.cn/bianma/wenbenjiami.php?s=yinyue%EF%BC%8C%E5%BE%97%E5%88%B0flag">https://www.qqxiuzi.cn/bianma/wenbenjiami.php?s=yinyue，得到flag</a></p>
<h2 id="MRCTF2020-千层套路"><a href="#MRCTF2020-千层套路" class="headerlink" title="[MRCTF2020]千层套路"></a>[MRCTF2020]千层套路</h2><p>压缩包一层套一层，解压密码就是文件名，利用python有关zip解压的库<code>zipfile</code>来自动化解压，参考文章主要是<a target="_blank" rel="noopener" href="https://www.cnblogs.com/gufengchen/archive/2019/05/31/10956009.html%EF%BC%8Chttps://blog.csdn.net/qq_33485434/article/details/82253642">https://www.cnblogs.com/gufengchen/archive/2019/05/31/10956009.html，https://blog.csdn.net/qq_33485434/article/details/82253642</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line">workdir = <span class="string">&#x27;D:\\0Study2\\CTF\\MRCTF2020\misc\\&#x27;</span></span><br><span class="line">filename = <span class="string">&#x27;0573.zip&#x27;</span></span><br><span class="line">path = workdir + filename</span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    path = workdir + filename</span><br><span class="line">    mainfile = zipfile.ZipFile(path, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">    password = filename[:<span class="number">4</span>].encode()</span><br><span class="line">    print(password)</span><br><span class="line">    mainfile.extractall(path=workdir, pwd=password)</span><br><span class="line">    filename = mainfile.namelist()[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># context = zipfile.ZipFile(path,&#x27;r&#x27;)</span></span><br><span class="line"><span class="comment"># print(context.namelist())</span></span><br><span class="line"><span class="comment"># filename = context.namelist()[0]</span></span><br><span class="line"><span class="comment"># path = (pwd + filename)</span></span><br><span class="line"><span class="comment"># context.extractall(path=pwd ,pwd=b&quot;0573&quot;)</span></span><br></pre></td></tr></table></figure>
<p>执行完后发现真的有1000个压缩包，最后一个文件是qr.txt，执行到最后脚本报错停止</p>
<p>qr.txt 是一个RGB的向量，用Python有关image的库解决，参考文章<a target="_blank" rel="noopener" href="https://blog.csdn.net/caobin0825/article/details/80338438%EF%BC%8Chttps://blog.csdn.net/leemboy/article/details/83792729">https://blog.csdn.net/caobin0825/article/details/80338438，https://blog.csdn.net/leemboy/article/details/83792729</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="comment"># 200 * 200</span></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&quot;D:\\0Study2\\CTF\\MRCTF2020\misc\\qr.txt&quot;</span>,<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">img = Image.new(<span class="string">&quot;RGB&quot;</span>,(<span class="number">200</span>,<span class="number">200</span>))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">200</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">200</span>):</span><br><span class="line">        a = f.readline()</span><br><span class="line">        pixTuple = (<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">15</span>)</span><br><span class="line">        <span class="keyword">if</span> a == <span class="string">&quot;(255, 255, 255)\n&quot;</span>:</span><br><span class="line">            pixTuple = (<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">15</span>)</span><br><span class="line">        <span class="keyword">elif</span> a == <span class="string">&quot;(0, 0, 0)\n&quot;</span>:</span><br><span class="line">            pixTuple = (<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">15</span>)</span><br><span class="line">        <span class="keyword">elif</span> a == <span class="string">&quot;&quot;</span>:</span><br><span class="line">            print(<span class="string">&quot;error&quot;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        img.putpixel((i, j), pixTuple)</span><br><span class="line"></span><br><span class="line">img.save(<span class="string">&quot;D:\\0Study2\\CTF\\MRCTF2020\misc\\final.png&quot;</span>)</span><br><span class="line">print(<span class="string">&quot;ok&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>得到二维码图片，扫描得到flag</p>
<h2 id="MRCTF2020-pyFlag"><a href="#MRCTF2020-pyFlag" class="headerlink" title="[MRCTF2020]pyFlag"></a>[MRCTF2020]pyFlag</h2><p>三张图片，最后都有数据，提取出来组合成一个zip，ARCHPR爆破弱密码，得到txt文件</p>
<p>base家族解一解即可，用Python的base64库，没有base48，base48即base32之后base16</p>
<h2 id="MRCTF2020-keyboard"><a href="#MRCTF2020-keyboard" class="headerlink" title="[MRCTF2020]keyboard"></a>[MRCTF2020]keyboard</h2><p>九键键盘，对着手机九键直接解即可</p>
<p>提交<code>mobilephond</code>发现不对，猜一猜是<code>mobilephone</code>即可</p>
<h1 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h1><h2 id="MRCTF2020-Easy-RSA"><a href="#MRCTF2020-Easy-RSA" class="headerlink" title="[MRCTF2020]Easy_RSA"></a>[MRCTF2020]Easy_RSA</h2><h3 id="已知fn和n"><a href="#已知fn和n" class="headerlink" title="已知fn和n"></a>已知fn和n</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">fn &#x3D; (p-1)(q-1) &#x3D; p*q - (p+q) + 1</span><br><span class="line">n - fn &#x3D; (p+q) - 1</span><br><span class="line">可以求(p+q),又已知p*q,进而可以求p,q</span><br></pre></td></tr></table></figure>
<h3 id="已知e-d和n"><a href="#已知e-d和n" class="headerlink" title="已知e*d和n"></a>已知e*d和n</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">e*d &#x3D; k*fn + 1 &#x3D; k(pq - (p+q) + 1) + 1</span><br><span class="line">(e*d - 1) &#x2F;&#x2F; n &#x3D; k - (p+q)&#x2F;&#x2F;n + 1&#x2F;&#x2F;n</span><br><span class="line">想一下(p+q)&#x2F;&#x2F;n小于1，1&#x2F;&#x2F;n也是，所以(e*d - 1) &#x2F;&#x2F; n &#x3D; k - 零点几</span><br><span class="line">(e*d - 1) &#x2F;&#x2F; n 的损失补回这零点几 成为1</span><br><span class="line">所以(e*d - 1) &#x2F;&#x2F; n &#x3D; k - 1</span><br><span class="line">可以求k，之后可以求fn了</span><br></pre></td></tr></table></figure>
<p>最终解密脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">P_n =  <span class="number">14057332139537395701238463644827948204030576528558543283405966933509944444681257521108769303999679955371474546213196051386802936343092965202519504111238572269823072199039812208100301939365080328518578704076769147484922508482686658959347725753762078590928561862163337382463252361958145933210306431342748775024336556028267742021320891681762543660468484018686865891073110757394154024833552558863671537491089957038648328973790692356014778420333896705595252711514117478072828880198506187667924020260600124717243067420876363980538994101929437978668709128652587073901337310278665778299513763593234951137512120572797739181693</span></span><br><span class="line">P_F_n =  <span class="number">14057332139537395701238463644827948204030576528558543283405966933509944444681257521108769303999679955371474546213196051386802936343092965202519504111238572269823072199039812208100301939365080328518578704076769147484922508482686658959347725753762078590928561862163337382463252361958145933210306431342748775024099427363967321110127562039879018616082926935567951378185280882426903064598376668106616694623540074057210432790309571018778281723710994930151635857933293394780142192586806292968028305922173313521186946635709194350912242693822450297748434301924950358561859804256788098033426537956252964976682327991427626735740</span></span><br><span class="line">Q_n =<span class="number">20714298338160449749545360743688018842877274054540852096459485283936802341271363766157976112525034004319938054034934880860956966585051684483662535780621673316774842614701726445870630109196016676725183412879870463432277629916669130494040403733295593655306104176367902352484367520262917943100467697540593925707162162616635533550262718808746254599456286578409187895171015796991910123804529825519519278388910483133813330902530160448972926096083990208243274548561238253002789474920730760001104048093295680593033327818821255300893423412192265814418546134015557579236219461780344469127987669565138930308525189944897421753947</span></span><br><span class="line">Q_E_D =<span class="number">100772079222298134586116156850742817855408127716962891929259868746672572602333918958075582671752493618259518286336122772703330183037221105058298653490794337885098499073583821832532798309513538383175233429533467348390389323225198805294950484802068148590902907221150968539067980432831310376368202773212266320112670699737501054831646286585142281419237572222713975646843555024731855688573834108711874406149540078253774349708158063055754932812675786123700768288048445326199880983717504538825498103789304873682191053050366806825802602658674268440844577955499368404019114913934477160428428662847012289516655310680119638600315228284298935201</span></span><br><span class="line">Ciphertext =  <span class="number">40855937355228438525361161524441274634175356845950884889338630813182607485910094677909779126550263304194796000904384775495000943424070396334435810126536165332565417336797036611773382728344687175253081047586602838685027428292621557914514629024324794275772522013126464926990620140406412999485728750385876868115091735425577555027394033416643032644774339644654011686716639760512353355719065795222201167219831780961308225780478482467294410828543488412258764446494815238766185728454416691898859462532083437213793104823759147317613637881419787581920745151430394526712790608442960106537539121880514269830696341737507717448946962021</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, isPrime, getRandomNBitInteger, bytes_to_long, long_to_bytes</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_P_Q</span>(<span class="params">P_n,P_F_n</span>):</span></span><br><span class="line">    P_plus_Q = P_n - P_F_n + <span class="number">1</span></span><br><span class="line">    Q_sub_P = gmpy2.iroot(P_plus_Q * P_plus_Q - <span class="number">4</span> * P_n, <span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">    <span class="comment"># print(P_plus_Q * P_plus_Q - 4 * P_n)</span></span><br><span class="line">    <span class="comment"># print(P_sub_Q * P_sub_Q)</span></span><br><span class="line">    Q = (P_plus_Q + Q_sub_P) // <span class="number">2</span></span><br><span class="line">    P = P_plus_Q - Q</span><br><span class="line">    <span class="comment"># print(Q)</span></span><br><span class="line">    <span class="comment"># print(P)</span></span><br><span class="line">    <span class="comment"># print(P*Q)</span></span><br><span class="line">    <span class="keyword">return</span> P,Q</span><br><span class="line">P,Q = get_P_Q(P_n,P_F_n)</span><br><span class="line">factor2 = <span class="number">2021</span> * P + <span class="number">2020</span> * Q</span><br><span class="line">p = sympy.nextprime(factor2)</span><br><span class="line"></span><br><span class="line">K = (Q_E_D-<span class="number">1</span>)//Q_n + <span class="number">1</span></span><br><span class="line">fn = (Q_E_D-<span class="number">1</span>)//K</span><br><span class="line">P,Q = get_P_Q(Q_n,fn)</span><br><span class="line">factor2 = <span class="number">2021</span> * P - <span class="number">2020</span> * Q</span><br><span class="line">q = sympy.nextprime(factor2)</span><br><span class="line"></span><br><span class="line">fn = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">n = p*q</span><br><span class="line">e = gmpy2.mpz(<span class="number">65537</span>)</span><br><span class="line">d = gmpy2.invert(e, fn)</span><br><span class="line">m = <span class="built_in">pow</span>(Ciphertext,d,n)</span><br><span class="line">print(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<h2 id="MRCTF2020-babyRSA"><a href="#MRCTF2020-babyRSA" class="headerlink" title="[MRCTF2020]babyRSA"></a>[MRCTF2020]babyRSA</h2><p>q 白给，p又是一个RSA结构，解出即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">P_p = <span class="number">206027926847308612719677572554991143421</span></span><br><span class="line">P_factor = <span class="number">213671742765908980787116579976289600595864704574134469173111790965233629909513884704158446946409910475727584342641848597858942209151114627306286393390259700239698869487469080881267182803062488043469138252786381822646126962323295676431679988602406971858136496624861228526070581338082202663895710929460596143281673761666804565161435963957655012011051936180536581488499059517946308650135300428672486819645279969693519039407892941672784362868653243632727928279698588177694171797254644864554162848696210763681197279758130811723700154618280764123396312330032986093579531909363210692564988076206283296967165522152288770019720928264542910922693728918198338839</span></span><br><span class="line">Q_1 = <span class="number">103766439849465588084625049495793857634556517064563488433148224524638105971161051763127718438062862548184814747601299494052813662851459740127499557785398714481909461631996020048315790167967699932967974484481209879664173009585231469785141628982021847883945871201430155071257803163523612863113967495969578605521</span></span><br><span class="line">Q_2 =  <span class="number">151010734276916939790591461278981486442548035032350797306496105136358723586953123484087860176438629843688462671681777513652947555325607414858514566053513243083627810686084890261120641161987614435114887565491866120507844566210561620503961205851409386041194326728437073995372322433035153519757017396063066469743</span></span><br><span class="line">sub_Q =<span class="number">168992529793593315757895995101430241994953638330919314800130536809801824971112039572562389449584350643924391984800978193707795909956472992631004290479273525116959461856227262232600089176950810729475058260332177626961286009876630340945093629959302803189668904123890991069113826241497783666995751391361028949651</span></span><br><span class="line">Ciphertext =  <span class="number">1709187240516367141460862187749451047644094885791761673574674330840842792189795049968394122216854491757922647656430908587059997070488674220330847871811836724541907666983042376216411561826640060734307013458794925025684062804589439843027290282034999617915124231838524593607080377300985152179828199569474241678651559771763395596697140206072537688129790126472053987391538280007082203006348029125729650207661362371936196789562658458778312533505938858959644541233578654340925901963957980047639114170033936570060250438906130591377904182111622236567507022711176457301476543461600524993045300728432815672077399879668276471832</span></span><br><span class="line">base = <span class="number">65537</span></span><br><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, isPrime, getRandomNBitInteger, bytes_to_long, long_to_bytes</span><br><span class="line"><span class="comment"># Q = sub_Q ** Q_2 % Q_1</span></span><br><span class="line">Q = <span class="built_in">pow</span>(sub_Q,Q_2,Q_1)</span><br><span class="line">q = sympy.nextprime(Q)</span><br><span class="line">P = [<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">17</span>)]</span><br><span class="line">P[<span class="number">9</span>] = P_p</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>, <span class="number">17</span>):</span><br><span class="line">    <span class="comment"># print(i,end = &#x27;,&#x27;)</span></span><br><span class="line">    P[i] = sympy.nextprime(P[i-<span class="number">1</span>])</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">    P[i] = sympy.prevprime(P[i+<span class="number">1</span>])</span><br><span class="line">    <span class="comment"># print(i,end = &#x27;,&#x27;)</span></span><br><span class="line">n = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">17</span>):</span><br><span class="line">    n *= P[i]</span><br><span class="line"><span class="comment"># factor = pow(p, base, n)</span></span><br><span class="line">fn = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">17</span>):</span><br><span class="line">    fn *= (P[i]-<span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(base, fn)</span><br><span class="line">p = <span class="built_in">pow</span>(P_factor, d, n)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p = sympy.nextprime(p)</span><br><span class="line">fn = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">n = p*q</span><br><span class="line">e = gmpy2.mpz(<span class="number">65537</span>)</span><br><span class="line">d = gmpy2.invert(e, fn)</span><br><span class="line">m = <span class="built_in">pow</span>(Ciphertext,d,n)</span><br><span class="line">print(long_to_bytes(m))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">John Doe</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="http://example.com/2021/04/06/MRCTF2020-misc-Crypto/">http://example.com/2021/04/06/MRCTF2020-misc-Crypto/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/misc/">misc</a><a class="post-meta__tags" href="/tags/crypto/">crypto</a></div><nav id="pagination"><div class="prev-post pull-left"><a href="/2021/05/13/%E4%B8%A4%E5%8F%B0linux%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%B1%80%E5%9F%9F%E7%BD%91%E9%80%9A%E4%BF%A1/"><i class="fa fa-chevron-left">  </i><span>两台linux虚拟机局域网通信</span></a></div><div class="next-post pull-right"><a href="/2021/03/29/DASCTF2021%E4%B8%89%E6%9C%88%E6%9C%88%E8%B5%9BRE/"><span>DASCTF2021三月月赛RE</span><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2013 - 2021 By John Doe</div><div class="framework-info"><span>Driven - </span><a target="_blank" rel="noopener" href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a target="_blank" rel="noopener" href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.9.0"></script><script src="/js/fancybox.js?version=1.9.0"></script><script src="/js/sidebar.js?version=1.9.0"></script><script src="/js/copy.js?version=1.9.0"></script><script src="/js/fireworks.js?version=1.9.0"></script><script src="/js/transition.js?version=1.9.0"></script><script src="/js/scroll.js?version=1.9.0"></script><script src="/js/head.js?version=1.9.0"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script></body></html>