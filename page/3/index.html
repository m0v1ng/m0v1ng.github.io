<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content=""><meta name="keywords" content=""><meta name="author" content="John Doe"><meta name="copyright" content="John Doe"><title>Hexo</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.9.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.9.0"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  hexoVersion: '5.3.0'
} </script><meta name="generator" content="Hexo 5.3.0"></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="false"><div class="author-info"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">John Doe</div><div class="author-info__description text-center"></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">23</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">21</span></a></div></div></div><nav class="no-bg" id="nav"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Hexo</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right"></span></div><div id="site-info"><div id="site-title">Hexo</div><div id="site-sub-title"></div></div></nav><div id="content-outer"><div class="layout" id="content-inner"><div class="recent-post-item article-container"><a class="article-title" href="/2021/03/17/vnctf2021-FilpGame/">vnctf2021-FilpGame</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-03-17</time><div class="content"><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>vnctf2021比赛期间我只看了一下reverse的FilpGame，当时写了脚本跑出来了其中一个答案，但是题目要求答案一定是最短的，正当我脑袋卡住的时候，同学邀我出去玩，比赛就咕咕咕了，现在官方wp出来了，我就回来重新看一下这题</p>
<h1 id="我的思路"><a href="#我的思路" class="headerlink" title="我的思路"></a>我的思路</h1><p>先说说我的思路吧，我自己感觉还是很正确的。IDA分析（结合题目FilpGame）发现是个十字翻棋游戏，果断上网找这个游戏的脚本<code>https://blog.csdn.net/gagaprince/article/details/50532055</code>，感觉这个blog的解法完美了，于是问题变成了异或方程组求解，异或方程组用高斯消元，可以看这个博客复习一下<code>https://blog.csdn.net/lzyws739307453/article/details/89816311/</code></p>
<p>我就开始用c++写解密程序，结果不知道什么原因它一直说无解，于是我决定用python，sagemath来写脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">c = []</span><br><span class="line">b = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>,<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>,<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>,<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>,<span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">    c.append([<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>)])</span><br><span class="line">    <span class="keyword">if</span> i &lt; <span class="number">16</span>:</span><br><span class="line">        <span class="keyword">if</span> i % <span class="number">16</span> == <span class="number">0</span>:</span><br><span class="line">            c[i][i] = <span class="number">1</span></span><br><span class="line">            c[i][i+<span class="number">1</span>] = <span class="number">1</span></span><br><span class="line">            c[i][i + <span class="number">16</span>] = <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> i % <span class="number">16</span> == <span class="number">15</span>:</span><br><span class="line">            c[i][i] = <span class="number">1</span></span><br><span class="line">            c[i][i - <span class="number">1</span>] = <span class="number">1</span></span><br><span class="line">            c[i][i + <span class="number">16</span>] = <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            c[i][i] = <span class="number">1</span></span><br><span class="line">            c[i][i - <span class="number">1</span>] = <span class="number">1</span></span><br><span class="line">            c[i][i + <span class="number">1</span>] = <span class="number">1</span></span><br><span class="line">            c[i][i + <span class="number">16</span>] = <span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> i+<span class="number">16</span>&gt;<span class="number">255</span>:</span><br><span class="line">        <span class="keyword">if</span> i % <span class="number">16</span> == <span class="number">0</span>:</span><br><span class="line">            c[i][i] = <span class="number">1</span></span><br><span class="line">            c[i][i + <span class="number">1</span>] = <span class="number">1</span></span><br><span class="line">            c[i][i - <span class="number">16</span>] = <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> i % <span class="number">16</span> == <span class="number">15</span>:</span><br><span class="line">            c[i][i] = <span class="number">1</span></span><br><span class="line">            c[i][i - <span class="number">1</span>] = <span class="number">1</span></span><br><span class="line">            c[i][i - <span class="number">16</span>] = <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            c[i][i] = <span class="number">1</span></span><br><span class="line">            c[i][i - <span class="number">1</span>] = <span class="number">1</span></span><br><span class="line">            c[i][i + <span class="number">1</span>] = <span class="number">1</span></span><br><span class="line">            c[i][i - <span class="number">16</span>] = <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">if</span> i % <span class="number">16</span> == <span class="number">0</span>:</span><br><span class="line">            c[i][i] = <span class="number">1</span></span><br><span class="line">            c[i][i + <span class="number">1</span>] = <span class="number">1</span></span><br><span class="line">            c[i][i - <span class="number">16</span>] = <span class="number">1</span></span><br><span class="line">            c[i][i + <span class="number">16</span>] = <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> i % <span class="number">16</span> == <span class="number">15</span>:</span><br><span class="line">            c[i][i] = <span class="number">1</span></span><br><span class="line">            c[i][i - <span class="number">1</span>] = <span class="number">1</span></span><br><span class="line">            c[i][i - <span class="number">16</span>] = <span class="number">1</span></span><br><span class="line">            c[i][i + <span class="number">16</span>] = <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            c[i][i] = <span class="number">1</span></span><br><span class="line">            c[i][i - <span class="number">1</span>] = <span class="number">1</span></span><br><span class="line">            c[i][i + <span class="number">1</span>] = <span class="number">1</span></span><br><span class="line">            c[i][i - <span class="number">16</span>] = <span class="number">1</span></span><br><span class="line">            c[i][i + <span class="number">16</span>] = <span class="number">1</span></span><br><span class="line">F = GF(<span class="number">2</span>)</span><br><span class="line">A = Matrix(F, c)</span><br><span class="line">result = A.solve_right(vector(b))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(result)):</span><br><span class="line">    <span class="keyword">if</span> result[i] == <span class="number">1</span>:</span><br><span class="line">        print(<span class="built_in">hex</span>(i)[<span class="number">2</span>:].rjust(<span class="number">2</span>,<span class="string">&#x27;0&#x27;</span>)[::-<span class="number">1</span>].upper(),end = <span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment">#102050A0F00111314151617191A1B1C1F13242526292B2D2F2032343537383A3B3C3E324346484A4C4F4051555758595A5B5C5E51666C6377787A7C7D7E7F708184868C8D8E8F809192979C9E91A3A4A5A7A8AAABACADAFA0B2B3B7B8B9BABBBCBDBFB0C2C4C5C6CACBCDC0D1D2D3D5D6D7DADBDCDDDED0E2E3E5E6E7EAEBEEEFE0F1F2F7F</span></span><br></pre></td></tr></table></figure>
<p>得到的结果输入程序发现是wrong，调试一下才发现原来是长度超了，估计是有自由变元，我patch了一下程序限制的长度，验证了我这个答案是正确的，但不是最短的，我翻了翻sagemath的文档，似乎没有写出通解的函数。</p>
<p>至此我就卡住了，我只能自己写一个高斯消元并且穷举，但是我的程序总是不对，最后也没整出来</p>
<h1 id="wp学习"><a href="#wp学习" class="headerlink" title="wp学习"></a>wp学习</h1><p>看了作者给出的wp，穷举第一行的可能性，其他行由第一行推出，因为第一行各列之间的影响已经固定，所以第一行只能由第二行影响，第二行可以由第一行推出，以此类推。确实是个可行的办法</p>
<p>下面给出作者的脚本，我按照我的理解加了点注释，官方wp在公众号 <code>白帽100安全攻防实验室</code></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 16</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">char</span> a[MAXN][MAXN], g[MAXN][MAXN];</span><br><span class="line"><span class="keyword">int</span> dx[] = &#123; <span class="number">-1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span> &#125;, dy[] = &#123; <span class="number">0</span>, <span class="number">0</span>, <span class="number">-1</span>, <span class="number">1</span>, <span class="number">0</span> &#125;, ans;</span><br><span class="line"><span class="built_in">vector</span> &lt; <span class="built_in">pair</span>&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; &gt; PathVec;</span><br><span class="line"><span class="built_in">vector</span> &lt; <span class="built_in">pair</span>&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; &gt; PathAns;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">filp</span><span class="params">(<span class="keyword">int</span> y, <span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	PathVec.push_back(<span class="built_in">make_pair</span>(x, y));</span><br><span class="line">	ans++;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">int</span> nx = x + dx[i], ny = y + dy[i];</span><br><span class="line">		<span class="keyword">if</span> (<span class="number">0</span> &lt;= nx &amp;&amp; nx &lt; MAXN &amp;&amp; <span class="number">0</span> &lt;= ny &amp;&amp; ny &lt; MAXN) g[ny][nx] ^= <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> min_Ans = <span class="number">1000</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">1</span> &lt;&lt; <span class="number">16</span>; i++) <span class="comment">//爆破第一行的所有可能</span></span><br><span class="line">	&#123;</span><br><span class="line">		PathVec.clear();</span><br><span class="line">		ans = <span class="number">0</span>;</span><br><span class="line">		<span class="built_in">memcpy</span>(g, a, <span class="keyword">sizeof</span>(a));</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; MAXN; j++)</span><br><span class="line">			<span class="keyword">if</span> (i &gt;&gt; j &amp; <span class="number">1</span>) filp(<span class="number">0</span>, j);</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; MAXN - <span class="number">1</span>; j++) <span class="comment">//其他行由第一行推出，因为第一行各列之间的影响已经固定，所以第一行只能由第二行影响，第二行可以由第一行推出，以此类推</span></span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; MAXN; k++)</span><br><span class="line">				<span class="keyword">if</span> (g[j][k] == <span class="number">0</span>) filp(j + <span class="number">1</span>, k);</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; MAXN; j++)<span class="comment">//最后一行有0则代表这个第一行不行</span></span><br><span class="line">			<span class="keyword">if</span> (g[MAXN - <span class="number">1</span>][j] == <span class="number">0</span>)</span><br><span class="line">				<span class="keyword">goto</span> next;</span><br><span class="line">		<span class="keyword">if</span> (min_Ans &gt; ans)<span class="comment">//要翻的次数最少的情况</span></span><br><span class="line">		&#123;</span><br><span class="line">			PathAns.assign(PathVec.begin(), PathVec.end());</span><br><span class="line">			min_Ans = ans;</span><br><span class="line">		&#125;</span><br><span class="line">	next:;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (min_Ans == <span class="number">1000</span>) min_Ans = <span class="number">-1</span>;</span><br><span class="line">	<span class="keyword">return</span> min_Ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">char</span> <span class="title">ToChar</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (x &gt;= <span class="number">10</span>) <span class="keyword">return</span> x - <span class="number">10</span> + <span class="string">&#x27;A&#x27;</span>;</span><br><span class="line">	<span class="keyword">return</span> x + <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">short</span> data[MAXN] = &#123; <span class="number">0xBEF5</span>, <span class="number">0x8BBC</span>, <span class="number">0xA0E9</span>, <span class="number">0x7310</span>, <span class="number">0xD910</span>, <span class="number">0xA3AD</span>, <span class="number">0xCCB6</span>, <span class="number">0x4DDE</span>, <span class="number">0x344C</span>, <span class="number">0x3BD6</span>, <span class="number">0x6711</span>, <span class="number">0x868F</span>, <span class="number">0x1C7A</span>, <span class="number">0x8425</span>, <span class="number">0x6B0D</span>, <span class="number">0x1B4C</span> &#125;;</span><br><span class="line">	<span class="keyword">while</span> (<span class="literal">true</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">/*</span></span><br><span class="line"><span class="comment">		memset(data, 0, sizeof(data));</span></span><br><span class="line"><span class="comment">		time_t t;</span></span><br><span class="line"><span class="comment">		srand((unsigned)time(&amp;t));</span></span><br><span class="line"><span class="comment">		for (int i = 0; i &lt; MAXN; i++)</span></span><br><span class="line"><span class="comment">		&#123;</span></span><br><span class="line"><span class="comment">			for (int j = 0; j &lt; MAXN; j++)</span></span><br><span class="line"><span class="comment">				data[i] = data[i] &lt;&lt; 1 | (rand() % 2);</span></span><br><span class="line"><span class="comment">		&#125;</span></span><br><span class="line"><span class="comment">		*/</span></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; MAXN; i++)</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; MAXN; j++)</span><br><span class="line">				a[i][j] = data[i] &gt;&gt; (MAXN - <span class="number">1</span> - j) &amp; <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">int</span> ans = solve();</span><br><span class="line">		<span class="keyword">if</span> (ans != <span class="number">-1</span>) <span class="keyword">break</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> x : PathAns)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%c%c&quot;</span>, ToChar(x.first), ToChar(x.second));</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; MAXN; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;0x%X, &quot;</span>, data[i]);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>十字翻棋游戏最大的弱点是每一个点只能两种状态：被点击和不被点击，点击两次和不被点击是一样的。我的方法是高斯消元，但是有自由变元，即有多解，理论上来说写出通解穷举一下应该也行，毕竟是个GF(2)。作者的方法是爆破第一行，由第一行推出其他行，涵盖了所有可能的解，并且爆破只有<code>2**16</code>，是一个非常好的思路</p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/01/30/ELF%E5%87%BD%E6%95%B0%E5%88%A9%E7%94%A8/">ELF函数利用</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-01-30</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/reverse/">reverse</a></span><div class="content"><h1 id="映射函数到指定内存进行利用"><a href="#映射函数到指定内存进行利用" class="headerlink" title="映射函数到指定内存进行利用"></a>映射函数到指定内存进行利用</h1><blockquote>
<p>灵感来源于比赛D^3CTF赛题ancient</p>
</blockquote>
<p>有这样一个场景，某个ELF文件，里面有一个函数，参数是flag其中一个字符，若正确返回1，错误返回0 ，main 函数调用这个函数逐字符判断flag是否正确。但是这个函数较为复杂，我们无法分析清楚，是个黑盒。显然可以逐字符爆破，但是，怎么爆破？这里我将提供一种思路：mmap映射该函数到内存，然后调用该函数进行爆破</p>
<p>思路</p>
<ol>
<li>环境搭建</li>
<li>dump内存</li>
<li>mmap映射并爆破</li>
</ol>
<h2 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim sayhello.c</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">check</span><span class="params">(<span class="keyword">int</span> n)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;n);</span><br><span class="line">        <span class="keyword">if</span>(check(n)==<span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>,<span class="string">&quot;hello world&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>,<span class="string">&quot;wrong&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">check</span><span class="params">(<span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(n==<span class="number">360</span>)</span><br><span class="line">                <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc sayhello.c -no-pie -o .&#x2F;hello64</span><br></pre></td></tr></table></figure>
<h2 id="dump内存"><a href="#dump内存" class="headerlink" title="dump内存"></a>dump内存</h2><p>ida 分析一下<code>hello64</code>程序，发现要完整内存在0x400000到0x405000之间</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gdb .&#x2F;hello64</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">gef➤  start</span><br><span class="line">gef➤  dump binary memory .&#x2F;hello64_dump 0x400000 0x405000 </span><br><span class="line">gef➤  q</span><br></pre></td></tr></table></figure>
<h2 id="mmap映射并爆破"><a href="#mmap映射并爆破" class="headerlink" title="mmap映射并爆破"></a>mmap映射并爆破</h2><p>编写 利用程序 use</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim use.c</span><br></pre></td></tr></table></figure>
<p><code>0x401205</code>是文件<code>hello64</code>  check函数地址</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/types.h&gt;//这里提供类型pid_t和size_t的定义</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/stat.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/mman.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> n = <span class="number">0</span>;</span><br><span class="line">	int fd = open(&#x27;./hello64_dump&#x27;,O_RDONLY);</span><br><span class="line">	mmap((<span class="keyword">void</span> *)<span class="number">0x400000</span>,<span class="number">0x5000</span>,PROT_EXEC | PROT_READ | PROT_WRITE ,MAP_PRIVATE |MAP_FIXED,fd,<span class="number">0</span>);</span><br><span class="line">	close(fd);</span><br><span class="line">	mprotect((<span class="keyword">void</span> *)<span class="number">0x400000</span>, <span class="number">0x5000</span>, PROT_EXEC | PROT_READ);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">1000</span>;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span>(((<span class="keyword">int</span> (*)(<span class="keyword">int</span>))<span class="number">0x401205</span>)(n) == <span class="number">1</span>)</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;success:%d\n&quot;</span>,i);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;finish\n&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">4eve3n1ght@ubuntu:~&#x2F;Desktop&#x2F;re$ gcc use.c -o .&#x2F;use</span><br><span class="line">4eve3n1ght@ubuntu:~&#x2F;Desktop&#x2F;re$ .&#x2F;use</span><br><span class="line">success:360</span><br><span class="line">finish</span><br></pre></td></tr></table></figure>
<p>参考文献</p>
<ul>
<li>mprotect用法<a target="_blank" rel="noopener" href="https://blog.csdn.net/Roland_Sun/article/details/33728955">https://blog.csdn.net/Roland_Sun/article/details/33728955</a></li>
<li>open用法<a target="_blank" rel="noopener" href="https://blog.csdn.net/renlonggg/article/details/80701949">https://blog.csdn.net/renlonggg/article/details/80701949</a></li>
<li>mmap函数用法<a target="_blank" rel="noopener" href="https://blog.csdn.net/yangle4695/article/details/52139585">https://blog.csdn.net/yangle4695/article/details/52139585</a></li>
</ul>
<h1 id="Patch程序输出关键数据利用"><a href="#Patch程序输出关键数据利用" class="headerlink" title="Patch程序输出关键数据利用"></a>Patch程序输出关键数据利用</h1><p>另外一个思路：Patch程序，使得程序自己输出关键数据，利用pwntool检查关键数据并进行爆破</p>
<h2 id="环境搭建-1"><a href="#环境搭建-1" class="headerlink" title="环境搭建"></a>环境搭建</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim xor.c</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">switch_input</span><span class="params">(<span class="keyword">char</span>* input)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">// input = &quot;hello_mmy_friend&quot;</span></span><br><span class="line">	<span class="keyword">char</span>* input = <span class="built_in">malloc</span>(<span class="number">0x10</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,input);</span><br><span class="line">	switch_input(input);</span><br><span class="line">	<span class="keyword">if</span>(!<span class="built_in">strcmp</span>(input,<span class="string">&quot;KFOOL|NNZ|EQJFMG&quot;</span>))</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>,<span class="string">&quot;you are right&quot;</span>);</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>,<span class="string">&quot;wrong!&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">switch_input</span><span class="params">(<span class="keyword">char</span>* input)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="built_in">strlen</span>(input);i++)</span><br><span class="line">		input[i] ^= <span class="number">35</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc xor.c -no-pie -o .&#x2F;xor</span><br></pre></td></tr></table></figure>
<h2 id="Patch程序"><a href="#Patch程序" class="headerlink" title="Patch程序"></a>Patch程序</h2><p>这里我使用 ida 的 KeyPatch 插件把<code>if ( !strcmp(s1, &quot;KFOOL|NNZ|EQJFMG&quot;) )</code> 的汇编代码改成了<code>printf(&quot;%s&quot;,s1)</code>，然后直接 jmp 到 main函数末尾</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">.text:00000000004011E8 ; 6:   switch_input(s1);</span><br><span class="line">.text:00000000004011E8                 mov     rax, [rbp+s1]</span><br><span class="line">.text:00000000004011EC                 mov     rdi, rax</span><br><span class="line">.text:00000000004011EF                 call    switch_input</span><br><span class="line">.text:00000000004011F4 ; 7:   if ( !strcmp(s1, &quot;KFOOL|NNZ|EQJFMG&quot;) )</span><br><span class="line">.text:00000000004011F4                 mov     rsi, rdi        ; Keypatch modified this from:</span><br><span class="line">.text:00000000004011F4                                         ;   mov rax, [rbp+s1]</span><br><span class="line">.text:00000000004011F4                                         ;   lea rsi, s2</span><br><span class="line">.text:00000000004011F4                                         ; Keypatch padded NOP to next boundary: 4 bytes</span><br><span class="line">.text:00000000004011F4                                         ; Keypatch modified this from:</span><br><span class="line">.text:00000000004011F4                                         ;   mov rdi, offset format</span><br><span class="line">.text:00000000004011F4                                         ; Keypatch padded NOP to next boundary: 4 bytes</span><br><span class="line">.text:00000000004011F7                 mov     rdi, offset format ; Keypatch modified this from:</span><br><span class="line">.text:00000000004011F7                                         ;   nop</span><br><span class="line">.text:00000000004011F7                                         ;   nop</span><br><span class="line">.text:00000000004011F7                                         ;   nop</span><br><span class="line">.text:00000000004011F7                                         ;   nop</span><br><span class="line">.text:00000000004011F7                                         ;   nop</span><br><span class="line">.text:00000000004011F7                                         ;   nop</span><br><span class="line">.text:00000000004011F7                                         ;   nop</span><br><span class="line">.text:00000000004011FE                 call    _printf         ; Keypatch modified this from:</span><br><span class="line">.text:00000000004011FE                                         ;   nop</span><br><span class="line">.text:00000000004011FE                                         ;   mov rdi, rax</span><br><span class="line">.text:00000000004011FE                                         ;   call _strcmp</span><br><span class="line">.text:00000000004011FE                                         ; Keypatch padded NOP to next boundary: 4 bytes</span><br><span class="line">.text:00000000004011FE                                         ; Keypatch modified this from:</span><br><span class="line">.text:00000000004011FE                                         ;   call ___isoc99_scanf</span><br><span class="line">.text:0000000000401203                 jmp     short locret_401242 ; Keypatch modified this from:</span><br><span class="line">.text:0000000000401203                                         ;   nop</span><br><span class="line">.text:0000000000401203                                         ;   nop</span><br><span class="line">.text:0000000000401205 ; ---------------------------------------------------------------------------</span><br><span class="line">.text:0000000000401205                 nop</span><br><span class="line">.text:0000000000401206                 nop</span><br></pre></td></tr></table></figure>
<p>命名为<code>./xor_patched</code>，运行一下程序</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">4eve3n1ght@ubuntu:~&#x2F;Desktop&#x2F;re$ .&#x2F;xor_patched </span><br><span class="line">312312aaa</span><br><span class="line">BBB</span><br></pre></td></tr></table></figure>
<p>这里只回显了可打印的字符串，无法打印的字节序列要通过pwntool才能看到</p>
<h2 id="利用脚本"><a href="#利用脚本" class="headerlink" title="利用脚本"></a>利用脚本</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">cmp_data = <span class="string">&#x27;KFOOL|NNZ|EQJFMG&#x27;</span></span><br><span class="line">print_table = <span class="string">&quot;0123456789_qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">burst</span>(<span class="params">offset,cmp_char</span>):</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(print_table)):</span><br><span class="line">        <span class="comment"># sleep(0.3)</span></span><br><span class="line">        p = process(<span class="string">&#x27;./xor_patched&#x27;</span>)</span><br><span class="line">        payload = <span class="string">b&#x27;0&#x27;</span>*offset + print_table[i].encode() + <span class="string">b&#x27;0&#x27;</span>*(<span class="number">15</span>-offset)</span><br><span class="line">        p.sendline(payload)</span><br><span class="line">        recv = p.recv()</span><br><span class="line">        p.close()</span><br><span class="line">        <span class="keyword">if</span> recv[offset] == <span class="built_in">ord</span>(cmp_char):</span><br><span class="line">            <span class="keyword">return</span> print_table[i]</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">    flag += burst(i,cmp_data[i])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>
<p>执行脚本得到 <code>hello_mmy_friend</code></p>
<h1 id="说点什么"><a href="#说点什么" class="headerlink" title="说点什么"></a>说点什么</h1><p>本人是一名2019级信息安全专业的学生，学习计算机技术有一年半多了。从刚入学对计算机一片空白，到现在也算是摸清计算机体系的脉络了。我是个CTFer，主要负责Reverse方向的赛题，逆向分析主要是经验的积累，但是我这最近半年为了开拓视野，学习了各个方面的知识，并没有花精力在逆向上，逆向实力处于一个半调子水平，比赛的时候经常自闭后摸鱼，所以Reverse方向上总是拖队伍后腿。</p>
<p>最近无所事事不知道自己该干什么，或许是时候重新拾起逆向了，接下来我可能会发blog分享一些我的收获</p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/01/29/Linux-Ubuntu%E6%90%AD%E5%BB%BAHexo%E5%8D%9A%E5%AE%A2/">Linux-Ubuntu搭建Hexo博客</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-01-29</time><div class="content"><h1 id="Linux-Ubuntu搭建Hexo博客"><a href="#Linux-Ubuntu搭建Hexo博客" class="headerlink" title="Linux-Ubuntu搭建Hexo博客"></a>Linux-Ubuntu搭建Hexo博客</h1><h3 id="安装Hexo"><a href="#安装Hexo" class="headerlink" title="安装Hexo"></a>安装Hexo</h3><p>Hexo 是一个基于node.js 的静态博客网站生成器，所以首先需要安装 Node.js</p>
<p>Node.js是能够在服务器端运行的 JavaScript 的开源、跨平台运行环境</p>
<p>npm（Node Package Manager）是Node.js的包管理器。npm是一个命令行工具，我这里也需要安装</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">su root</span><br><span class="line">apt install nodejs</span><br><span class="line">nodejs -v</span><br><span class="line">apt install npm </span><br><span class="line">npm -v</span><br><span class="line">npm install -g hexo-cli</span><br><span class="line">hexo -v</span><br></pre></td></tr></table></figure>
<h3 id="初始化Hexo"><a href="#初始化Hexo" class="headerlink" title="初始化Hexo"></a>初始化Hexo</h3><p>创建一个文件夹，存放 本地博客 信息</p>
<p>这里我在 <code>/home/k2016</code> 目录下创建 一个 <code>blog</code> 文件夹</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /home/k2016</span><br><span class="line">mkdir blog</span><br><span class="line"><span class="built_in">cd</span> blog</span><br><span class="line">hexo init</span><br></pre></td></tr></table></figure>
<p>初始化完成后，可以通过命令 <code>hexo server</code> 开启本地服务，通过浏览器url  <code>127.0.0.1:4000</code> 就可以本地访问博客</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu:/home/k2016/blog<span class="comment"># hexo server</span></span><br><span class="line">INFO  Validating config</span><br><span class="line">INFO  Start processing</span><br><span class="line">INFO  Hexo is running at http://localhost:4000 . Press Ctrl+C to stop.</span><br></pre></td></tr></table></figure>
<h3 id="写文章"><a href="#写文章" class="headerlink" title="写文章"></a>写文章</h3><p>通过 <code>hexo new</code> 命令新建一个文章</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu:/home/k2016/blog# hexo new &quot;my first blog article&quot;</span><br><span class="line">root@ubuntu:/home/k2016/blog# hexo new &quot;my first blog article&quot;</span><br><span class="line">INFO  Validating config</span><br><span class="line">INFO  Created: /home/k2016/blog/source/_posts/my-first-blog-article.md</span><br><span class="line"></span><br><span class="line">root@ubuntu:/home/k2016/blog# cd ./source/_posts</span><br><span class="line">root@ubuntu:/home/k2016/blog/source/_posts# ls</span><br><span class="line">hello-world.md  my-first-blog-article.md</span><br><span class="line"></span><br><span class="line">root@ubuntu:/home/k2016/blog/source/_posts# vim my-first-blog-article.md </span><br><span class="line">root@ubuntu:/home/k2016/blog/source/_posts# cat my-first-blog-article.md </span><br></pre></td></tr></table></figure>
<p>文章写完后，更新 Hexo</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo clean</span><br><span class="line">hexo generate</span><br></pre></td></tr></table></figure>
<h3 id="部署到github"><a href="#部署到github" class="headerlink" title="部署到github"></a>部署到github</h3><p>github 登录后按右上角加号 新建一个仓库repository</p>
<p><code>Repository name</code> 填  <code>用户名.github.io</code> ，我这里用户名是 <code>m0v1ng</code></p>
<p>安装 hexo-deployer-git</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save hexo-deployer-git</span><br></pre></td></tr></table></figure>
<p>修改 配置文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd &#x2F;home&#x2F;k2016&#x2F;blog</span><br><span class="line">vim _config.yml</span><br></pre></td></tr></table></figure>
<p>修改 deploy(部署) 属性，m0v1ng是用用户名</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">deploy:</span><br><span class="line">  type: git</span><br><span class="line">  repo: https:&#x2F;&#x2F;github.com&#x2F;m0v1ng&#x2F;m0v1ng.github.io.git</span><br><span class="line">  branch: master</span><br></pre></td></tr></table></figure>
<p>修改完成后执行命令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git config --global user.email &quot;邮箱&quot;</span><br><span class="line">git config --global user.name &quot;用户名&quot;</span><br><span class="line">hexo deploy</span><br></pre></td></tr></table></figure>
<p>之后输入github密码即可完成部署，其他电脑可以通过url <code>https://m0v1ng.github.io/</code>  访问个人博客</p>
<h3 id="修改博客主题"><a href="#修改博客主题" class="headerlink" title="修改博客主题"></a>修改博客主题</h3><p>把 github 上的 hexo 主题 yilia 安装到 <code>./themes/yilia</code> 目录下，命令<code>git clone https://github.com/litten/hexo-theme-yilia.git themes/yilia</code></p>
<p>修改 配置文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd &#x2F;home&#x2F;k2016&#x2F;blog</span><br><span class="line">vim _config.yml</span><br></pre></td></tr></table></figure>
<p>修改 theme(主题) 属性</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># Extensions</span><br><span class="line">## Plugins: https:&#x2F;&#x2F;hexo.io&#x2F;plugins&#x2F;</span><br><span class="line">## Themes: https:&#x2F;&#x2F;hexo.io&#x2F;themes&#x2F;</span><br><span class="line">theme: yilia</span><br></pre></td></tr></table></figure>
<p>更新 Hexo</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo clean</span><br><span class="line">hexo generate</span><br></pre></td></tr></table></figure>
<p>部署到 github 上</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo deploy</span><br></pre></td></tr></table></figure>
<h1 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h1><p>bilibili  BV1Yb411a7ty</p>
<p>wikipedia</p>
<h1 id="hexo-deploy报错"><a href="#hexo-deploy报错" class="headerlink" title="hexo deploy报错"></a>hexo deploy报错</h1><p>2021.3.17更新，最近遇到这个问题：<code>hexo deploy</code> 回显</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu:/home/k2016/blog# hexo d</span><br><span class="line">INFO  Validating config</span><br><span class="line">INFO  Deploying: git</span><br><span class="line">INFO  Clearing .deploy_git folder...</span><br><span class="line">INFO  Copying files from public folder...</span><br><span class="line">INFO  Copying files from extend dirs...</span><br><span class="line">On branch master</span><br><span class="line">nothing to commit, working tree clean</span><br><span class="line">fatal: unable to access &#x27;https://github.com/m0v1ng/m0v1ng.github.io.git/&#x27;: gnutls_handshake() failed: Error in the pull function.</span><br><span class="line">FATAL &#123; err:</span><br><span class="line">   &#123; Error: Spawn failed</span><br><span class="line">       at ChildProcess.task.on.code (/home/k2016/blog/node_modules/hexo-deployer-git/node_modules/hexo-util/lib/spawn.js:51:21)</span><br><span class="line">       at ChildProcess.emit (events.js:198:13)</span><br><span class="line">       at Process.ChildProcess._handle.onexit (internal/child_process.js:248:12) code: 128 &#125; &#125; &#x27;Something\&#x27;s wrong. Maybe you can find the solution here: %s&#x27; &#x27;\u001b[4mhttps://hexo.io/docs/troubleshooting.html\u001b[24m&#x27;</span><br></pre></td></tr></table></figure>
<p>似乎是网络问题，有时候可以有时候不可以，很玄学，待解决</p>
</div><hr></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-chevron-left"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2013 - 2021 By John Doe</div><div class="framework-info"><span>Driven - </span><a target="_blank" rel="noopener" href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a target="_blank" rel="noopener" href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_site_uv"><i class="fa fa-user"></i><span id="busuanzi_value_site_uv"></span><span></span></span><span class="footer-separator">|</span><span id="busuanzi_container_site_pv"><i class="fa fa-eye"></i><span id="busuanzi_value_site_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.9.0"></script><script src="/js/fancybox.js?version=1.9.0"></script><script src="/js/sidebar.js?version=1.9.0"></script><script src="/js/copy.js?version=1.9.0"></script><script src="/js/fireworks.js?version=1.9.0"></script><script src="/js/transition.js?version=1.9.0"></script><script src="/js/scroll.js?version=1.9.0"></script><script src="/js/head.js?version=1.9.0"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script></body></html>